# 早发冠心病数据处理工具集 🏥

专业的Excel数据合并、去重工具集，专为医学研究数据处理设计。

## 🚀 快速开始

### 方法1：使用启动器（推荐）
双击 `启动工具.bat`，选择需要的工具。

### 方法2：直接运行
```bash
# 单文件多Sheet合并
python tools/merge_tool_gui.py

# 跨文件合并
python tools/cross_merge_gui.py

# 重复记录去重
python tools/deduplicate_tool.py

# 字段唯一性检查
python tools/check_join_fields.py
```

## 📚 详细文档

请查看 [工具使用指南.md](工具使用指南.md) 了解：
- 详细功能说明
- 操作步骤图解
- 常见问题解答
- 最佳实践建议

## 🛠️ 工具概览

| 工具 | 功能 | 适用场景 |
|------|------|----------|
| **merge_tool_gui.py** | 单文件多Sheet合并 | 同一文件的不同sheet需要合并 |
| **cross_merge_gui.py** | 跨文件合并 | 两个文件的数据需要按ID关联 |
| **deduplicate_tool.py** | 重复记录去重 | 数据中有重复的患者记录 |
| **check_join_fields.py** | 字段唯一性检查 | 合并前检查哪个字段适合作为ID |

## ⚠️ 重要提示

**跨文件合并时，务必使用唯一的ID字段！**

✅ **正确：** subjid, patient_id, case_number  
❌ **错误：** 姓名, 年龄, 性别, 日期

工具会自动检查并警告，请留意提示信息！

## 🔧 环境要求

- Python 3.8+
- pandas
- openpyxl
- fuzzywuzzy
- tkinter（GUI支持）

安装依赖：
```bash
pip install -r requirements.txt
```

## 📁 项目结构

```
Early CHD Project/
├── tools/           # 核心工具
├── docs/            # 数据文件
├── archive/         # 旧版本工具
├── 启动工具.bat     # 快速启动器
└── 工具使用指南.md  # 详细文档
```

## 💡 使用示例

### 示例1：合并患者基本信息和检查结果
1. 运行 `merge_tool_gui.py`
2. 选择包含多个sheet的Excel文件
3. 自动合并完成！

### 示例2：合并两个文件的数据
1. 运行 `check_join_fields.py` 检查哪个字段唯一
2. 运行 `cross_merge_gui.py`
3. 选择正确的ID字段
4. 选择merge类型（推荐Left join）
5. 完成合并！

## 📝 更新日志

**2025-10-25**
- ✅ 添加GUI文件选择功能
- ✅ 添加字段唯一性检查和警告
- ✅ 支持不同字段名的ID匹配
- ✅ 创建项目文档和启动器

---

**如有问题，请参阅《工具使用指南.md》** 📖
